<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ìƒí’ˆ ëª©ë¡ - ìº í¼ìŠ¤</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="topbar topbar-sub">
    <div class="left">
      <button class="icon back" id="backBtn" aria-label="ë’¤ë¡œ ê°€ê¸°">â—€</button>
    </div>
    <div class="center">
      <button class="location-btn" id="locBtn">
        <span id="locName">North Campus</span>
        <span class="chev">â–¾</span>
      </button>
    </div>
    <div class="right">
      <button class="icon" id="searchBtn" aria-label="ê²€ìƒ‰">ğŸ”</button>
      <button class="icon" id="addBtn" aria-label="ë“±ë¡">ï¼‹</button>
    </div>
  </header>

  <!-- ìƒì„¸ ì •ë³´ ëª¨ë‹¬ -->
  <div id="detailModalSub" class="modal">
    <div class="modal-overlay"></div>
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="modalTitleSub"></h2>
        <button class="modal-close" id="modalCloseSub">âœ•</button>
      </div>
      <div class="modal-body">
        <div class="modal-info">
          <p><strong>ìš”ì²­ ë‚´ìš©:</strong> <span id="modalDetailSub"></span></p>
          <p><strong>ê°€ê²©:</strong> <span id="modalPriceSub"></span></p>
          <p><strong>ìº í¼ìŠ¤:</strong> <span id="modalCampusSub"></span></p>
          <p><strong>í¬ë§ì¸ì›:</strong> <span id="modalCapacitySub"></span></p>
          <p><strong>í˜„ì¬ ì‹ ì²­:</strong> <span id="modalApplicantsSub"></span></p>
        </div>
      </div>
      <div class="modal-footer">
        <button id="applyBtnSub" class="apply-btn">ì§€ì›í•˜ê¸°</button>
      </div>
    </div>
  </div>

  <main class="container">
    <section class=\"detail-section\">
      <div class=\"detail-card\">
        <h2 id=\"detailTitleSub\" class=\"detail-title\"></h2>
        <p id=\"detailTypeSub\" class=\"detail-type\"></p>
        <div class=\"detail-main\">
          <p><strong>ìš”ì²­ ë‚´ìš©:</strong> <span id=\"detailDetailSub\"></span></p>
          <p><strong>ì˜ˆìƒ ë¹„ìš©:</strong> <span id=\"detailPriceSub\" class=\"price-highlight\"></span></p>
          <p><strong>ì„œë¹„ìŠ¤ ìœ„ì¹˜:</strong> <span id=\"detailCampusSub\"></span></p>
          <p><strong>ëª¨ì§‘ í˜„í™©:</strong> <span id=\"detailStatusSub\"></span></p>
        </div>
        <div class=\"detail-actions\">
          <button id=\"detailApplyBtn\" class=\"apply-btn\">ì§€ì›í•˜ê¸°</button>
        </div>
      </div>
    </section>

    <section class=\"list\">
      <h3>\ucd94\ucc9c \uc694\uccad</h3>
      <ul id="itemsListSub"></ul>
    </section>
  </main>

  <template id="itemTemplateSub">
    <li class="item-card" data-id="">
      <div class="item-body">
        <span class="item-type"></span>
        <h3 class="item-title"></h3>
        <p class="item-detail"></p>
        <div class="item-stats">
          <span class="item-capacity"></span>
          <span class="item-applicants"></span>
        </div>
        <div class="item-meta">
          <span class="item-price"></span>
          <span class="item-campus"></span>
        </div>
      </div>
    </li>
  </template>

  <script>
  // ê°„ë‹¨í•œ ë™ì‘: ë’¤ë¡œê°€ê¸° ë° ë”ë¯¸ ë Œë”
  document.getElementById('backBtn').addEventListener('click', ()=>history.back());
  
  const modalSub = document.getElementById('detailModalSub');
  const modalCloseSub = document.getElementById('modalCloseSub');
  const modalOverlaySub = modalSub.querySelector('.modal-overlay');
  const applyBtnSub = document.getElementById('applyBtnSub');
  
  function openModalSub(itemData) {
    document.getElementById('modalTitleSub').textContent = itemData.title;
    document.getElementById('modalDetailSub').textContent = itemData.detail;
    document.getElementById('modalPriceSub').textContent = itemData.price;
    document.getElementById('modalCampusSub').textContent = campusMap[itemData.campus] || itemData.campus;
    document.getElementById('modalCapacitySub').textContent = itemData.capacity + 'ëª…';
    document.getElementById('modalApplicantsSub').textContent = itemData.applicants + 'ëª…';
    
    const canApply = itemData.applicants < itemData.capacity;
    applyBtnSub.textContent = canApply ? 'ì§€ì›í•˜ê¸°' : 'ë§ˆê°ë¨';
    applyBtnSub.classList.toggle('full', !canApply);
    applyBtnSub.disabled = !canApply;
    applyBtnSub.dataset.item = JSON.stringify(itemData);
    
    modalSub.classList.add('active');
  }
  
  function closeModalSub() {
    modalSub.classList.remove('active');
  }
  
  modalCloseSub.addEventListener('click', closeModalSub);
  modalOverlaySub.addEventListener('click', closeModalSub);
  
  applyBtnSub.addEventListener('click', (e) => {
    const itemData = JSON.parse(e.target.dataset.item);
    if(itemData.applicants < itemData.capacity) {
      itemData.applicants++;
      closeModalSub();
    }
  });
  
  const campusMap = {'north':'Northìº í¼ìŠ¤','south':'Southìº í¼ìŠ¤','east':'Eastìº í¼ìŠ¤'};
  const sample = [
    {title:'ì±… ë°°ë‹¬ (êµì¬ ë°°ì†¡)',price:'â‚©3,000',campus:'north',detail:'êµì¬ 1ê¶Œ ë°°ë‹¬ â€” 1ì¼',type:'ë°°ë‹¬',typeClass:'delivery',capacity:2,applicants:1},
    {title:'ëŒ€ë¦¬êµ¬ë§¤: ë§ˆíŠ¸',price:'â‚©5,000',campus:'north',detail:'ë§ˆíŠ¸ êµ¬ë§¤ ë° ì „ë‹¬ â€” 2ì‹œê°„',type:'êµ¬ë§¤ëŒ€í–‰',typeClass:'purchase',capacity:3,applicants:0}
  ];
  const listRoot = document.getElementById('itemsListSub');
  const tpl = document.getElementById('itemTemplateSub');
  
  sample.forEach(it=>{
    const node = tpl.content.cloneNode(true);
    const typeEl = node.querySelector('.item-type');
    typeEl.textContent = it.type || '';
    if(it.typeClass) typeEl.classList.add(`type-${it.typeClass}`);
    node.querySelector('.item-title').textContent = it.title;
    node.querySelector('.item-detail').textContent = it.detail || '';
    node.querySelector('.item-price').textContent = it.price;
    node.querySelector('.item-campus').textContent = campusMap[it.campus] || it.campus;
    node.querySelector('.item-capacity').textContent = `í¬ë§ ${it.capacity || 1}ëª…`;
    node.querySelector('.item-applicants').textContent = `ì‹ ì²­ ${it.applicants || 0}ëª…`;
    listRoot.appendChild(node);
  });
  
  listRoot.addEventListener('click', (e) => {
    const card = e.target.closest('.item-card');
    if(card) {
      const idx = Array.from(listRoot.children).indexOf(card);
      openModalSub(sample[idx]);
    }
  });
  </script>
</body>
</html>
